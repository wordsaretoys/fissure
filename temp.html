
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Fissure :: Words Are Toys</title>
		<link rel="stylesheet" type="text/css" media="screen" href="fissure.css">
		<link rel="stylesheet" type="text/css" media="screen" href="/shared/toybox.css">
		<script type="text/javascript" src="/shared/jquery-1.6.2.js"></script>

		<script type="text/javascript" src="/debug/foam/foam.js"></script>
		<script type="text/javascript" src="/debug/foam/resources.js"></script>
		<script type="text/javascript" src="/debug/foam/vector.js"></script>
		<script type="text/javascript" src="/debug/foam/quaternion.js"></script>
		<script type="text/javascript" src="/debug/foam/shaders.js"></script>
		<script type="text/javascript" src="/debug/foam/textures.js"></script>
		<script type="text/javascript" src="/debug/foam/camera.js"></script>
		<script type="text/javascript" src="/debug/foam/mesh.js"></script>
		<script type="text/javascript" src="/debug/foam/noise.js"></script>
		
		<script type="text/javascript" src="/debug/fissure/fissure.js"></script>
		<script type="text/javascript" src="/debug/fissure/world.js"></script>
		<script type="text/javascript" src="/debug/fissure/player.js"></script>
		<script type="text/javascript" src="/debug/fissure/hud.js"></script>
		<script type="text/javascript" src="/debug/fissure/cave.js"></script>
		<script type="text/javascript" src="/debug/fissure/monologue.js"></script>
		<script type="text/javascript" src="/debug/fissure/salvage.js"></script>
		<script type="text/javascript" src="/debug/fissure/cloud.js"></script>
		<script type="text/javascript" src="/debug/fissure/junk.js"></script>

<script id="vs-cave" type="x-shader/x-vertex">

/**
	cave vertex shader
**/

attribute vec3 position;
attribute vec2 texturec;

uniform mat4 projector;
uniform mat4 modelview;
uniform vec3 camerapos;

varying vec4 lightpos;
varying vec4 fragmpos;
varying vec2 uv;

void main(void) {
	gl_Position = projector * modelview * vec4(position, 1.0);
	fragmpos = modelview * vec4(position,  1.0);
	lightpos = modelview * vec4(camerapos, 1.0);
	uv = texturec;
}

</script>
<script id="fs-cave" type="x-shader/x-fragment">

/**
	cave fragment shader
**/

#ifdef GL_ES
precision highp float;
#endif
 
uniform sampler2D tex0;

varying vec4 lightpos;
varying vec4 fragmpos;
varying vec2 uv;

void main(void) {
	vec4 lightToFrag = fragmpos - lightpos;
	float lightFactor = pow(clamp((500.0 - length(lightToFrag)) / 500.0, 0.0, 1.0), 2.0);

	vec3 t0 = texture2D(tex0, uv * 1.0).x * vec3(0.8, 0.4, 0.2);
	vec3 t1 = texture2D(tex0, uv * 5.0).x * vec3(0.3, 0.6, 0.8);
	vec3 t2 = texture2D(tex0, uv * 25.0).x * vec3(0.6, 0.8, 0.5);
	vec3 t  = t0 + t1 + t2;
	gl_FragColor = vec4(t * lightFactor, 1.0); 
}

</script>
<script id="vs-cloud" type="x-shader/x-vertex">

/**
	cloud vertex shader
**/

attribute vec3 position;
attribute vec2 texturec;

uniform mat4 projector;
uniform mat4 modelview;

varying vec2 uv;

void main(void) {
	gl_Position = projector * modelview * vec4(position, 1.0);
	uv = texturec;
}

</script>
<script id="fs-cloud" type="x-shader/x-fragment">

/**
	cloud fragment shader
**/

#ifdef GL_ES
precision highp float;
#endif
 
uniform sampler2D tex0;
uniform vec2 offset;

varying vec2 uv;

void main(void) {
	vec2 tt = vec2(uv.x + offset.x, uv.y + offset.y);

	float t = 	(texture2D(tex0, tt * 0.0001).x +
				texture2D(tex0, tt * 0.001).x + 
				texture2D(tex0, tt * 0.01).x) * 0.9; 
	
	gl_FragColor = vec4(vec3(0.0, 0.0, 0.0), t); 
}

</script>
<script id="vs-salvage" type="x-shader/x-vertex">

/**
	salvage vertex shader
**/

attribute vec3 position;
attribute vec2 texturec;

uniform mat4 projector;
uniform mat4 modelview;
uniform vec3 center;
uniform float scale;

varying vec2 uv;

void main(void) {
	vec3 rt = scale * vec4(position, 0.0).xyz + center;
	gl_Position = projector * modelview * vec4(rt, 1.0);
	uv = texturec;
}

</script>
<script id="fs-salvage" type="x-shader/x-fragment">

/**
	salvage fragment shader
**/

#ifdef GL_ES
precision highp float;
#endif
 
uniform sampler2D tex0;

varying vec2 uv;

void main(void) {
	gl_FragColor = texture2D(tex0, uv * 4.0);
}

</script>

		<script type="text/javascript">
			window.addEventListener("load", function() {
				FISSURE.init();
			});
		</script>
    </head>
	<body>
		<div id="toybox"><a href="/" title="Go to Home Page">WORDS ARE TOYS</a></div>

<noscript>
	<div>This application requires Javascript, which is not switched on.</div>
	<div>To switch it on, follow the directions <a href="http://www.activatejavascript.org/">here</a> for your specific browser.</div>
	<div><a href="/" title="Go to Home Page">WORDS ARE TOYS</a></div>
</noscript>
<div id="glerror">
	<div>This application requires <a href="http://www.khronos.org/webgl/wiki_1_15/index.php/Getting_a_WebGL_Implementation">WebGL</a>, which is either not available with your browser or not switched on.</div>
	<div>More information is available <a href="http://get.webgl.org/">here</a>.</div>
	<div><a href="/" title="Go to Home Page">WORDS ARE TOYS</a></div>
</div>

		<canvas id="gl"></canvas>
		<div id="hud">
			<div id="meters">
	<div id="emFrame" class="hud-meter-frame">
		<div id="emIcon" class="hud-meter-icon energy-icon"></div>
		<div id="emBox" class="hud-meter-box">
			<div id="emBar" class="hud-meter-bar">
				<div id="emReadout" class="hud-meter-readout"></div>
			</div>
		</div>
	</div>

	<div id="rmFrame" class="hud-meter-frame">
		<div id="rmIcon" class="hud-meter-icon rads-icon"></div>
		<div id="rmBox" class="hud-meter-box">
			<div id="rmBar" class="hud-meter-bar">
				<div id="rmReadout" class="hud-meter-readout"></div>
			</div>
		</div>
	</div>

	<div id="ssFrame" class="hud-meter-frame">
		<div id="ssIcon" class="hud-meter-icon signal-icon"></div>
		<div id="ssBox" class="hud-meter-box">
			<div id="ssBar" class="hud-meter-bar">
				<div id="ssReadout" class="hud-meter-readout"></div>
			</div>
		</div>
	</div>
</div>

<div id="monologue">
	<div id="mono0" class="mono"></div>
	<div id="mono1" class="mono"></div>
	<div id="mono2" class="mono"></div>
	<div id="mono3" class="mono"></div>
</div>

<div id="intro">

	<div id="intro-titles">FISSURE</div>

	<div class="border pad blackground">
		<div>
			<div class="left" style="width:20%; text-align: center">
				<img src="res/mouse.png">
			</div>
			<div class="left" style="width:70%">
				<br><br>
				Left-click and drag the mouse cursor to look around.
			</div>
		</div>

		<div class="clear space"></div>

		<div>
			<div class="left" style="width:20%; text-align: center">
				<table>
					<tr><td>&nbsp;</td><td class="border">W</td><td>&nbsp;</td></tr>
					<tr><td class="border">A</td><td class="border">S</td><td class="border">D</td></tr>
				</table>
			</div>
			<div class="left" style="width:70%">
				Use these keys to fire thrusters.<br>
				Thrust direction is relative to where you're looking.<br>
			</div>
		</div>
	
		<div class="clear space"></div>

		<div>
			<div class="left" style="width:20%; text-align: center">
				<table>
					<tr><td>&nbsp;</td><td class="border">Esc</td><td>&nbsp;</td></tr>
				</table>
			</div>
			<div class="left" style="width:70%">
				Use this key to pause the game and display the help.
			</div>
		</div>

		<div class="clear"></div>
	</div>	

	<div class="space">&nbsp;</div>

	<div class="border pad blackground">
		<div>Travel through the ashes of the Fissure Base to collect salvage.</div>
		<div>Use thrusters sparingly. Be patient. Let your momentum do the work.</div>
		<div>Radiation [<sub><div class="rads-icon"></div></sub>] and collisions with the cave wall drain energy [<sub><div class="energy-icon"></div></sub>].</div>
		<div>Salvage provides energy [<sub><div class="energy-icon"></div></sub>] and components, and unlocks the story.</div>
		<div>The EMF detector [<sub><div class="signal-icon"></div></sub>] indicates when you're pointed at a likely find.</div>
		<div>Fly into a salvage blob to scoop it up. Note that targets may be far away. </div>
	</div>

	<div class="space clear">&nbsp;</div>

	<div id="intro-box">
		<div id="intro-bar">
			<div id="intro-readout"></div>
		</div>
	</div>
	
	<div id="intro-start-button"><big>PRESS ENTER TO PLAY</big></div>
	<div id="intro-pause-button"><big>PRESS ESC TO RESUME</big></div>

</div>

<div id="curtain"></div>

<div id="credits">
	<div id="final-score"></div>
	<div>&nbsp;</div>
	<div>FISSURE Created by</div>
	<div><big>Chris Gauthier</big></div>
	<div>&nbsp;</div>
	<small>
		<div>Inspired by<br><i>The Gold at Starbow's End</i><br>by Frederik Pohl</div>
	</small>
	<div>&nbsp;</div>
	<div>PRESS ENTER TO PLAY AGAIN</div>
</div>

<div id="scorebox">
	<div class="left">
		<div>SALVAGED</div>
		<div id="progress">0 / 25</div>
	</div>
	<div class="left">
		<div>SCORE</div>
		<div id="score">0</div>
	</div>
</div>

		</div>
	</body>
</html>

